<div class="page-content">
  <header class="page-header">
    <h1 class="page-title">{{ pageTitle }}</h1>
    <p class="page-subtitle">{{ pageSubtitle }}</p>
  </header>

  <!-- Search and Add User Bar -->
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex items-center justify-between gap-4">
      <!-- Search Input -->
      <div class="flex-1 relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
        <form [formGroup]="searchForm">
          <input
            type="text"
            formControlName="search"
            placeholder="Search users..."
            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none"
          />
        </form>
      </div>

      <!-- Add User Button -->
      <button
        (click)="onAddUser()"
        class="flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors duration-200 shadow-sm"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        <span>Add User</span>
      </button>
    </div>
  </div>

  <!-- Users Table -->
  <div class="content-area">
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
      <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <!-- Table Header -->
        <thead>
          <tr class="border-b-2 border-gray-200">
            <th class="text-left py-3 px-4 font-semibold text-gray-700 uppercase text-sm">FULL NAME</th>
            <th class="text-left py-3 px-4 font-semibold text-gray-700 uppercase text-sm">EMAIL</th>
            <th class="text-left py-3 px-4 font-semibold text-gray-700 uppercase text-sm">ROLE</th>
            <th class="text-left py-3 px-4 font-semibold text-gray-700 uppercase text-sm">STATUS</th>
            <th class="text-left py-3 px-4 font-semibold text-gray-700 uppercase text-sm">CREATED AT</th>
            <th class="text-left py-3 px-4 font-semibold text-gray-700 uppercase text-sm">ACTIONS</th>
          </tr>
        </thead>

        <!-- Table Body -->
        <tbody>
          @if (isLoading) {
            <tr>
              <td colspan="6" class="py-8 text-center text-gray-500">
                <div class="flex items-center justify-center">
                  <svg class="animate-spin h-5 w-5 mr-3 text-purple-600" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  Loading users...
                </div>
              </td>
            </tr>
          } @else if (filteredUsers.length === 0) {
            <tr>
              <td colspan="6" class="py-8 text-center text-gray-500">
                No users found
              </td>
            </tr>
          } @else {
            @for (user of filteredUsers; track user.id) {
              <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">
                <!-- Full Name -->
                <td class="py-4 px-4 text-gray-900">
                  {{ user.name || 'N/A' }}
                </td>

                <!-- Email -->
                <td class="py-4 px-4 text-gray-700">
                  {{ user.email || 'N/A' }}
                </td>

                <!-- Role Badge -->
                <td class="py-4 px-4">
                  <span [class]="'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + getRoleBadgeClass(user.role)">
                    {{ user.role || 'N/A' }}
                  </span>
                </td>

                <!-- Status Badge -->
                <td class="py-4 px-4">
                  <span [class]="'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + getStatusBadgeClass(user)">
                    {{ getStatusText(user) }}
                  </span>
                </td>

                <!-- Created At -->
                <td class="py-4 px-4 text-gray-700">
                  {{ formatDate(user.createdAt) }}
                </td>

                <!-- Actions -->
                <td class="py-4 px-4">
                  <button
                    (click)="onEditUser(user)"
                    class="text-blue-600 hover:text-blue-800 transition-colors"
                    title="Edit user"
                  >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                  </button>
                </td>
              </tr>
            }
          }
        </tbody>
      </table>
      </div>
    </div>

    <!-- Pagination (if needed) -->
    @if (totalPages > 1) {
      <div class="mt-6 flex items-center justify-between">
        <div class="text-sm text-gray-700">
          Showing {{ getDisplayRange() }} users
        </div>
        <div class="flex gap-2">
          <button
            (click)="onPreviousPage()"
            [disabled]="currentPage === 1"
            class="px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors"
          >
            Previous
          </button>
          <button
            (click)="onNextPage()"
            [disabled]="currentPage === totalPages"
            class="px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors"
          >
            Next
          </button>
        </div>
      </div>
    }
  </div>
</div>

<!-- User Form Modal -->
<app-user-form
  [user]="selectedUser"
  [isOpen]="showUserForm"
  (close)="onCloseUserForm()"
  (save)="onSaveUser($event)"
></app-user-form>

